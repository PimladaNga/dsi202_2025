<!DOCTYPE html>
<html lang="th" class="scroll-smooth">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Chum-Chon Link{% endblock %}</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
        <style>
            body {
                font-family: 'Prompt', sans-serif; /* <<-- แก้ไขตรงนี้แล้ว */
            }
            .active-link {
                @apply text-purple-700 font-semibold;
            }
            .truncate_2_lines {
                overflow: hidden;
                text-overflow: ellipsis;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
            }
        </style>
    
    {% load static %}
    </head>
    <body class="bg-gray-100 min-h-screen flex flex-col"> {# เปลี่ยน bg-gray-50 เป็น bg-gray-100 เพื่อให้ navbar สีม่วงเด่นขึ้น #}
        <nav class="bg-purple-600 shadow-lg sticky top-0 z-50"> {# เปลี่ยนสีพื้นหลังเป็นสีม่วง, เพิ่มเงา #}
            <div class="container mx-auto px-4 py-4"> {# เพิ่ม Padding แนวตั้ง #}
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <a href="{% url 'home' %}" class="flex items-center space-x-2">
                            <img src="{% static 'images/whitelogo.png' %}" alt="Logo" class="h-10 w-10"> {# อาจจะปรับขนาดโลโก้เล็กน้อย #}
                            <span class="text-2xl font-bold text-white">Chum-Chon Link</span> {# เปลี่ยนสีชื่อแอปเป็นสีขาว #}
                        </a>
                    </div>
    
                    <div class="hidden md:flex items-center space-x-6">
                        <a href="{% url 'home' %}" class="px-3 py-2 rounded-md text-sm font-semibold {% if request.resolver_match.url_name == 'home' %}text-white bg-purple-700{% else %}text-purple-100 hover:text-white hover:bg-purple-500{% endif %} transition-colors duration-150">หน้าแรก</a>
                        <a href="{% url 'event_list' %}" class="px-3 py-2 rounded-md text-sm font-semibold {% if request.resolver_match.url_name == 'event_list' or request.resolver_match.url_name == 'event_detail' %}text-white bg-purple-700{% else %}text-purple-100 hover:text-white hover:bg-purple-500{% endif %} transition-colors duration-150">กิจกรรม</a>
                        {% if user.is_authenticated %}
                        <a href="{% url 'event_create' %}" class="px-3 py-2 rounded-md text-sm font-semibold {% if request.resolver_match.url_name == 'event_create' %}text-white bg-purple-700{% else %}text-purple-100 hover:text-white hover:bg-purple-500{% endif %} transition-colors duration-150">สร้างกิจกรรม</a>
                        {% endif %}
                    </div>
    
                    <div class="hidden md:flex items-center space-x-4">
                        {% if user.is_authenticated %}
                            <a href="{% url 'user_profile' %}" class="flex items-center text-sm font-semibold {% if request.resolver_match.url_name == 'user_profile' or request.resolver_match.url_name == 'edit_profile' or request.resolver_match.url_name == 'view_profile' %}text-white{% else %}text-purple-100 hover:text-white{% endif %} transition-colors duration-150">
                                {% if user.profile.profile_image %}
                                    <img src="{{ user.profile.profile_image.url }}" alt="{{user.username}}" class="h-8 w-8 rounded-full object-cover mr-2 border-2 border-purple-300"> {# เพิ่ม border ให้ avatar #}
                                {% else %}
                                    <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-purple-200 text-purple-700 mr-2 border-2 border-purple-300">
                                        <span class="text-sm font-medium leading-none">{{ user.username.0|upper }}</span>
                                    </span>
                                {% endif %}
                                โปรไฟล์
                            </a>
                            <a href="{% url 'logout' %}" class="bg-pink-500 hover:bg-pink-600 active:bg-pink-700 text-white px-4 py-2 rounded-md text-sm font-semibold transition-colors duration-150">ออกจากระบบ</a> {# เปลี่ยนสีปุ่ม Logout ให้ตัดกับพื้นหลังม่วง #}
                        {% else %}
                            <a href="{% url 'login' %}" class="text-purple-100 hover:text-white px-3 py-2 rounded-md text-sm font-semibold transition-colors duration-150">เข้าสู่ระบบ</a>
                            <a href="{% url 'signup' %}" class="bg-white hover:bg-gray-100 text-purple-600 px-4 py-2 rounded-md text-sm font-semibold transition-colors duration-150">สมัครสมาชิก</a> {# เปลี่ยนสีปุ่ม Signup ให้ตัดกับพื้นหลังม่วง #}
                        {% endif %}
                    </div>
    
                    <div class="md:hidden flex items-center">
                        <button id="hamburger-button" class="p-2 rounded-md text-purple-100 hover:text-white hover:bg-purple-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white transition-colors duration-150">
                            <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                    </div>
                </div>
    
                <div id="mobile-menu" class="hidden md:hidden mt-2 pb-3 space-y-1">
                    <a href="{% url 'home' %}" class="block px-3 py-2 rounded-md text-base font-medium {% if request.resolver_match.url_name == 'home' %}bg-purple-700 text-white{% else %}text-purple-100 hover:text-white hover:bg-purple-500{% endif %} transition-colors duration-150">หน้าแรก</a>
                    {# ... ปรับลิงก์อื่นๆ ใน mobile menu ให้ใช้สีที่ตัดกับพื้นหลังม่วง ... #}
                </div>
            </div>
        </nav>

    <main class="flex-grow container mx-auto px-4 py-6">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gray-100 border-t border-gray-200 py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0 text-center md:text-left">
                    <p class="text-sm text-gray-600">© {% now "Y" %} Chum-Chon Link - แพลตฟอร์มสำหรับการพบปะและทำกิจกรรมร่วมกัน</p>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="text-sm text-gray-600 hover:text-purple-700 transition-colors duration-150">เกี่ยวกับเรา</a>
                    <a href="#" class="text-sm text-gray-600 hover:text-purple-700 transition-colors duration-150">ติดต่อ</a>
                    <a href="#" class="text-sm text-gray-600 hover:text-purple-700 transition-colors duration-150">นโยบายความเป็นส่วนตัว</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        const hamburgerButton = document.getElementById('hamburger-button');
        const mobileMenu = document.getElementById('mobile-menu');

        hamburgerButton.addEventListener('click', () => {
            const expanded = hamburgerButton.getAttribute('aria-expanded') === 'true' || false;
            hamburgerButton.setAttribute('aria-expanded', !expanded);
            mobileMenu.classList.toggle('hidden');
        });

        // Optional: Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const isClickInsideNav = hamburgerButton.contains(event.target) || mobileMenu.contains(event.target);
            if (!isClickInsideNav && !mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
                hamburgerButton.setAttribute('aria-expanded', 'false');
            }
        });
    </script>
</body>
</html>